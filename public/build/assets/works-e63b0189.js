import{H as c}from"./helpers-6129a7c3.js";import"./jquery-7dadb4e7.js";function m(){let i=$(".work-action-checkbox:checked"),n=new FormData;for(let e in i){if(e=="length")break;let t=i[e];n.append("works[]",t.id)}return n}$(function(){$(document).on("click",".js_admin_work_del",function(){let e=$(this).parents("tr"),t=$(this).attr("data-route");$.ajax({url:t,method:"GET",dataType:"json",success:function(s){s.success?e.remove():($("#response .message").html(s.error+"<br/>"),UIkit.modal("#md-response").show())}})}),$(document).on("click",".js_admin_work_forceDel",function(){let e=$(this).parents("tr"),t=e.find(".js_title_work"),s=c.escapeHtml(t.text().trim());if(!confirm("Вы действительно хотите удалить запись с заголовком - "+s))return!1;let a=$(this).attr("data-route");$.ajax({url:a,method:"GET",dataType:"json",success:function(r){r.success?e.remove():($("#response .message").html(r.error+"<br/>"),UIkit.modal("#md-response").show())}})}),$(document).on("click",".js_admin_work_restore",function(){let e=$(this).parents("tr"),t=$(this).attr("data-route");$.ajax({url:t,method:"GET",dataType:"json",success:function(s){s.success?e.remove():($("#response .message").html(s.error+"<br/>"),UIkit.modal("#md-response").show())}})}),$("#js_work_edit_submit").on("click",function(e){e.preventDefault();let t=$(this).parents("form"),s=t.serializeArray(),o=new FormData;$.each(s,function(a,r){o.append(r.name,r.value)}),i(t,o)});async function i(e,t){let o="/works/"+e.find('[name="id"]').val()+"/update/",r=await(await fetch(o,{method:"POST",body:t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json();r.success?($("#md-response .message").text(r.result),UIkit.modal("#md-response").show(),c.updateWorksHtmlToAdmin()):UIkit.notification({message:r.error,status:"danger",timeout:5e3})}$("form#work-filter").on("submit",function(e){e.preventDefault();var t=$(this).attr("action"),s=$(this).serializeArray();let o=new URL(t);for(let a in s){let r=s[a].name,l=s[a].value;l&&o.searchParams.set(r,l)}location.href=o}),$(".works-actions .js-delete").on("click",()=>{let e=m();n("/admin/works/recycle/delete",e)}),$(".works-actions .js-restore").on("click",()=>{let e=m();n("/admin/works/recycle/restore",e)});async function n(e,t){let o=await(await fetch(e,{method:"POST",body:t,headers:{"X-CSRF-Token":$('meta[name="csrf-token"]').attr("content")}})).json();o.success?($("#md-response .message").text(o.result),UIkit.modal("#md-response").show(),c.updateWorksHtmlToAdmin()):UIkit.notification({message:o.error,status:"danger",timeout:5e3})}});
