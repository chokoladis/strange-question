import{H as i}from"./variables-6a1cfe8d.js";import"./jquery-7dadb4e7.js";$(function(){$(document).on("click",".js_work_del",function(){let t=$(this).parents(".work").attr("data-id");$.ajax({url:"/works/"+t+"/delete/",method:"GET",dataType:"json",success:function(a){a.success?($('.works_list [data-id="'+t+'"]').remove(),i.updateWorksHtml()):($("#response").show(),$("#response .message").html(a.error+"<br/>"))}})}),$("form#work-filter").on("submit",function(o){o.preventDefault();var t=$(this).attr("action"),a=$(this).serializeArray();let e=new URL(t);for(let s in a){let r=a[s].name,n=a[s].value;n&&e.searchParams.set(r,n)}location.href=e}),$(document).on("click",".js_work_edit",function(o){o.preventDefault();let t=$(this).parents(".work-detail");t.length||(t=$(this).parents(".work"));let a=t.attr("data-id");$.ajax({url:"/works/"+a+"/edit/",method:"GET",dataType:"json",success:function(e){if(e){let s=$("#md-work_edit");s.find('[name="id"]').val(a),s.find('[name="title"]').val(e.title),s.find('[name="description"]').val(e.description),s.find('[name="url_work"]').val(e.url_work),UIkit.modal("#md-work_edit").show()}else UIkit.modal("#md-response").show(),UIkit.modal("#md-response .message").html("Ошибка при получении данных <br/>")},error:function(e){let s="";e.status===403?s="У вас нет прав изменять данные <br/>":s=e.responseJSON.message,UIkit.notification({message:s,status:"danger",timeout:5e3})}})}),$("#js_work_edit_submit").on("click",function(o){o.preventDefault();let t=$(this).parents("form"),a=t.serializeArray(),e=new FormData;$.each(a,function(s,r){e.append(r.name,r.value)}),l(t,e)});async function l(o,t){let e="/works/"+o.find('[name="id"]').val()+"/update/",r=await(await fetch(e,{method:"POST",body:t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json();r.success?($("#md-response .message").text(r.result),UIkit.modal("#md-response").show(),i.updateWorksHtml()):UIkit.notification({message:r.error,status:"danger",timeout:5e3})}});
