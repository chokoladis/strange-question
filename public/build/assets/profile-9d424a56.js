import{H as f}from"./variables-6a1cfe8d.js";import"./jquery-7dadb4e7.js";async function m(){const e=await fetch("/profile/verify/resend",{method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});if(console.log(e),e.ok&&e.redirected)$("#md-response .message").text("Письмо для верификации почты отправлена"),UIkit.modal("#md-response").show();else throw UIkit.notification({message:e.statusText,status:"danger",timeout:5e3}),new Error(`Response status: ${e.status}`)}async function u(e,t){let a=e.attr("action"),n=await(await fetch(a,{method:"POST",body:t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json();n.success?($("#md-response .message").text(n.result),UIkit.modal("#md-response").show(),f.updWorkersHtml(),$("button.js-add-worker").remove()):UIkit.notification({message:n.error,status:"danger",timeout:5e3})}async function h(e,t){(await(await fetch(e.attr("action"),{method:e.attr("method"),body:t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json()).success&&$.ajax({url:location.href,success:function(n){let s=$(n).find(".form_change_img img").attr("src");$(".form_change_img img").attr("src",s)}})}async function p(e,t){let o=await(await fetch(e.attr("action"),{method:"POST",body:t,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json();o.success?location.href="/profile":UIkit.notification({message:o.error,status:"danger",timeout:5e3})}async function k(){let t=await(await fetch("/profile/delete",{method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json();t.success?location.href="/workers":UIkit.notification({message:t.error,status:"danger",timeout:5e3})}async function g(e){let a=await(await fetch(e,{method:"DELETE",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}})).json();a.success?location.href="/profile/works":UIkit.notification({message:a.error,status:"danger",timeout:5e3})}$(function(){$(".file_change").on("click",function(){$('input[name="url_avatar"]').click()}),$("#js_workers_add_submit").on("click",function(e){e.preventDefault();let t=0,a=$(this).parent("form");var o=a.serializeArray(),n=new FormData;$.each(o,function(d,r){let l=a.find('input[name="'+r.name+'"]');f.resetInput(l),l.length&&l.attr("require")&&r.value.length<1&&(f.showError(l,"Вы не заполнили обязательное поле"),t++),r.name!="socials"&&r.value!=""&&n.set(r.name,r.value)});var i=a.find('[name="photo"]')[0].files;i.length>0&&n.append("photo",i[0]);for(var s=$(".socials input"),c=0;c<s.length;c++){let d=$(s[c]).attr("id"),r=$(s[c]).val();r&&n.append("socials["+d+"]",r)}t||u(a,n)}),$('input[name="url_avatar"]').on("change",function(){let e=$(this)[0].files,t=$(this).parents("form"),a=new FormData;a.append("url_avatar",e[0]),h(t,a)}),$(document).on("click","#js_send_accept_email",()=>{m()}),$("#md-worker_add .photo input").on("change",function(){let e=this.files[0],t=$(this).siblings("p");e?(t.removeClass("uk-hidden"),t.text("Текущее изображение : "+e.name)):t.addClass("uk-hidden")}),$("form#worker_edit").on("submit",function(e){e.preventDefault();var t=$(this).serializeArray(),a=new FormData;$('meta[name="csrf-token"]').attr("content"),$.each(t,function(i,s){s.name!="socials"&&s.value!=""&&a.set(s.name,s.value)});for(var o=$(this).find(".socials input"),n=0;n<o.length;n++){let i=$(o[n]).attr("id"),s=$(o[n]).val();s&&a.append("socials["+i+"]",s)}p($(this),a)}),$("a.js_profile_delete").on("click",function(){confirm("Вы уверенны что хотите удалить профиль?")&&k()}),$(".js-profile-work-delete").on("click",function(){const e=$(this).attr("data-href");g(e)})});
